'use strict';

const getStatusCode = (statusCode) => {
    if (typeof statusCode === 'number' && statusCode >= 400 && statusCode < 600) {
        return statusCode;
    }

    return undefined;
};

const getStatusCodeFromErrorOrResponse = (error, response) => getStatusCode(error.statusCode) ||
    getStatusCode(error.status) || getStatusCode(response.statusCode) || 500;

const createErrorHandler = () => (error, _, response, __) => { // eslint-disable-line max-params, no-unused-vars
    const errorStatusCode = getStatusCodeFromErrorOrResponse(error, response);
    response
        .status(errorStatusCode)
        .json({error: error.message})
        .end();
};

module.exports = createErrorHandler;
